featuremodel "platform:/resource/org.openarchitectureware.demo.fm/org.openarchitectureware.demo.fm.xfm.xmi";

import 'components/lib.adsl'  

system collabSPL {

	system logic {
		using lib.types;
		
		struct UserInfo {
			username : string;
			name : string;
			status : int;
		}
		
		interface IMessageDispatcher{
			rr dispatch : request=( message : string, destinationID: int, conversationID: int ) 
						  reply=( conversationID : int );
		}
				  
		interface IMicroBloggingService  feature MicroBlogging { 
			oneway updateMessage: ( senderID: int , message: string); 
		}
		
		interface IInstantMessagingService feature SynchronousConferencing {
			oneway sendMessage: ( senderID: int, receiverID: int, message: string ); 
		}
		
		interface IForumService feature SynchronousConferencing {
			oneway updateMessage: ( senderID: int , threadID: int, message: string) ;
			rr openThread: request=( senderID: int, title: string ) reply=( threadID: int ); 
		}
		
		interface IAudioConnection feature Audio {
			rr call: request=(callerID: int, calleeID: int) reply=( callID: int );
		}
		
		interface IAudioService feature Audio {
			rr call: request=(callerID: int, calleeID: int) reply=( callID: int );
		}		
		
		persistencecomponent CollabDB {

		}
		
		blcomponent MessageDispatcher{
			provides dispatcher : IMessageDispatcher;
			requires imPort : IInstantMessagingService feature SynchronousConferencing; 
			requires mbPort: IMicroBloggingService     feature MicroBlogging;
			requires forumPort: IForumService          feature Forum;
			config {
				instancedef p1: text
			}
		}
		
		
		blcomponent InstantMessagingService feature SynchronousConferencing {
			provides toMany imPort: IInstantMessagingService;
			requires audioConnection: IAudioService feature Audio; 
			config {
			}
		}
		
		
		blcomponent MicroBloggingService feature MicroBlogging {
			provides toMany mbPort: IMicroBloggingService;
			config {
			}
		}
		
		
		blcomponent ForumService  feature Forum {
			provides toMany forumPort: IForumService;
			config {
			}
		}
		
		
		blcomponent AudioService  feature Audio {
			provides audioPort: IAudioService;
			requires audioConnection: IAudioConnection ;
			config {
			}
		}
		
		blcomponent TelephoneConnection  feature TelephoneIntegration {
			provides audioCon: IAudioConnection;
			config {
			}
		}
		
		blcomponent VOIPConnection  feature VoiceOverIP {
			provides audioCon: IAudioConnection;
			config {
			}
		}
		
		
	} 


}